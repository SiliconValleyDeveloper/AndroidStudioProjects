<!DOCTYPE html>
<html>
<head>
	<link href="../../prism.css" rel="stylesheet" />
      <link type="text/css" rel="stylesheet" href="../../materialize.css"  media="screen,projection"/>
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<script src="../../prism.js"></script>
	<style type="text/css">
    img {
    max-width: 100%;
    height: auto;
    width: auto\9;
}
p{font-size:medium;}
    </style>
</head>
<body>

<div class="container">

<br>
<center><h5>Linear Regression</h5></center>
<p><span style="font-size: medium;"><strong>Features of dataset:</strong></span></p>
<li><span style="font-size: medium;"><strong>Father - Height of father in inches.</strong></span><br></li>
<li><span style="font-size: medium;"><strong>Son - Height of son in inches.</strong></span></font></li>
<p><span style="font-size: medium;">Given the height of father we need to predict the height of son.&nbsp;</span>
<br>

<p><b>Import required libraries</b></p>
<center>
<pre><code class="language-python">
# For mathematical calculation
import numpy as np

# For handling datasets
import pandas as pd

# For plotting graphs
from matplotlib import pyplot as plt

# Import the sklearn library for linear regression
from sklearn.linear_model import LinearRegression
</code></pre>
</center>


<p><b>Import dataset</b></p>
<center>
<pre><code class="language-python">
# Import the csv file
df = pd.read_csv('data.csv'
	,delim_whitespace=True)

# prints the top 5 rows
print df.head()

'''
Output:
   Father   Son
0    65.0  59.8
1    63.3  63.2
2    65.0  63.3
3    65.8  62.8
4    61.1  64.3
'''
</code></pre>
</center>


<p><b>Prepare data for training</b></p>
<center>
<pre><code class="language-python">
# Prepare the training set
x_train = df['Father'].values[:,np.newaxis]
y_train = df['Son'].values
</code></pre>
</center>


<p><b>Train the model</b></p>
<center>
<pre><code class="language-python">
lm = LinearRegression()

# Train the model
lm.fit(x_train, y_train)
</code></pre>
</center>


<p><b>Test the model</b></p>
<center>
<pre><code class="language-python">
# Prepare the test data
x_test = [[72.8],[61.1],[67.4],[70.2],
			[75.6],[60.2],[65.3],[59.2]]

# Test the model
predictions = lm.predict(x_test)
print predictions

'''
Output:
[ 71.31243097  65.2985618   68.53679905
  69.9760156   72.75164753  64.83595648
  67.45738663  64.32195056]
'''
</code></pre>
</center>


<p><b>Plot the best fit line</b></p>
<center>
<pre><code class="language-python">
# Plot the training data
plt.scatter(x_train, y_train,color='b')

# Plot the best fit line using predicted value
plt.plot(x_test, predictions,color='black'
				,linewidth=3)
plt.xlabel('Father height in inches')
plt.ylabel('Son height in inches')
plt.show()
</code></pre>
</center>

<img src="lr.png">

<br><br><br><br><br><br><br><br>

</div>
</body>
</html>
